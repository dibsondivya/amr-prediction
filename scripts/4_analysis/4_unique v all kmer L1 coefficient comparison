import shap
import venn
import pandas as pd
import numpy as np
import joblib
import matplotlib.pyplot as plt
import os
from sklearn.linear_model import LogisticRegression


feature_imp3 = feature_imp2

def shapley_feature_ranking(j, X):
    feature_order = np.argsort(np.mean(np.abs(shap_values[j]), axis=0))
    return pd.DataFrame(
        {"class": best_rf.classes_[j],
         "model": "Random Forest",
            "features": [X.columns[i] for i in feature_order[::-1][:3]],
            "importance": [
                np.mean(np.abs(shap_values[j]), axis=0)[i] for i in feature_order[::-1][:3]
            ],
        }
    )
for i in range(len(best_rf.classes_)):
    output = shapley_feature_ranking(i, readfile_by_kmer_df)
    feature_imp3 = feature_imp3.append(output) 
